# ディレクトリ構成（Firebase Authentication × LINEログイン技術検証デモサイト）

本プロジェクトは、フロントエンド（Nuxt 3）とバックエンド（Firebase Functions）を完全に分離した構成を採用しています。

## 📁 ディレクトリ構成

```
firebase-line-example/
├── functions/                   # バックエンド：Firebase Functions（Node.js）
│   ├── src/
│   │   ├── index.ts            # Functions のエントリーポイント
│   │   ├── index.test.ts       # Functions のテストコード
│   │   └── handlers/
│   │       ├── lineCallback.ts # LINE OAuth コールバック処理
│   │       └── lineCallback.test.ts # LINE OAuth コールバック処理のテストコード
│   ├── package.json
│   ├── tsconfig.json
│   └── .eslintrc.json
│
├── frontend/                    # フロントエンド：Nuxt 3 アプリケーション
│   ├── pages/
│   │   ├── index.vue           # トップページ（ログインボタンなど）
│   │   └── dashboard.vue       # 認証後に遷移するページ
│   ├── composables/
│   │   └── useAuth.ts          # Firebase認証状態の管理用Composable
│   ├── plugins/
│   │   └── firebase.client.ts  # Firebase JS SDK の初期化
│   ├── assets/
│   │   └── css/
│   │       └── main.css        # メインスタイルシート
│   ├── nuxt.config.ts
│   ├── package.json
│   ├── tsconfig.json
│   └── .output/                # `nuxi build` による静的出力先
│
├── docs/                        # プロジェクトドキュメント
│   ├── ディレクトリ構成.md
│   ├── 実装計画.md
│   └── 要件定義.md
│
├── firebase.json               # Firebase Hosting & Functions 設定ファイル
├── .firebaserc                 # Firebase プロジェクト設定
└── README.md
```

## 🔧 firebase.json の設定例

```json
{
  "functions": {
    "source": "functions",
    "predeploy": [
      "npm --prefix \"$RESOURCE_DIR\" run lint",
      "npm --prefix \"$RESOURCE_DIR\" run build"
    ]
  },
  "hosting": {
    "public": "frontend/.output/public",
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ],
    "rewrites": [
      {
        "source": "/api/**",
        "function": "api"
      },
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  },
  "emulators": {
    "functions": {
      "port": 5001
    },
    "hosting": {
      "port": 5000
    },
    "auth": {
      "port": 9099
    },
    "ui": {
      "enabled": true
    }
  }
}
```

## 💡 備考

- Nuxt アプリは `nuxi build` を使って `.output/public` に静的サイトとしてビルドされ、Firebase Hosting から配信されます。
- API リクエスト（例: `/api/line-callback`）は Firebase Functions にルーティングされます。
- 開発・ビルド・デプロイのパイプラインをそれぞれ独立して管理できる構成です。
- テストコードは対象ファイルと同じディレクトリに配置されています。
- Firebase Emulator を使用してローカル開発環境でテストできます。
- 日本語と英語のバイリンガル対応（コメントとUI）を行っています。

