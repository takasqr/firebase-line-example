# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆFirebase Authentication Ã— LINEãƒ­ã‚°ã‚¤ãƒ³æŠ€è¡“æ¤œè¨¼ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆï¼‰

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆNuxt 3ï¼‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆFirebase Functionsï¼‰ã‚’å®Œå…¨ã«åˆ†é›¢ã—ãŸæ§‹æˆã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
firebase-line-example/
â”œâ”€â”€ functions/                   # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼šFirebase Functionsï¼ˆNode.jsï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts            # Functions ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ index.test.ts       # Functions ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”‚   â””â”€â”€ handlers/
â”‚   â”‚       â”œâ”€â”€ line.ts         # LINEãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼ˆlineCallbackHandlerã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼‰
â”‚   â”‚       â”œâ”€â”€ lineCallback.ts # LINE OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã®å®Ÿè£…
â”‚   â”‚       â””â”€â”€ lineCallback.test.ts # LINE OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ lib/                    # TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¾Œã®JavaScriptãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ .env.local              # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ç’°å¢ƒå¤‰æ•°
â”‚   â””â”€â”€ .env.local.example      # ç’°å¢ƒå¤‰æ•°ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ frontend/                    # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼šNuxt 3 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ index.vue           # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ãªã©ï¼‰
â”‚   â”‚   â””â”€â”€ dashboard.vue       # èªè¨¼å¾Œã«é·ç§»ã™ã‚‹ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ composables/
â”‚   â”‚   â””â”€â”€ useAuth.ts          # Firebaseèªè¨¼çŠ¶æ…‹ã®ç®¡ç†ç”¨Composable
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ AccountLinking.vue  # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªãƒ³ã‚¯ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ AccountLinkingError.vue # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â””â”€â”€ lineAuthProvider.ts # ã‚«ã‚¹ã‚¿ãƒ LINEèªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â””â”€â”€ firebase.client.ts  # Firebase JS SDK ã®åˆæœŸåŒ–
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â””â”€â”€ css/
â”‚   â”‚       â””â”€â”€ main.css        # ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ nuxt.config.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ .env                    # ç’°å¢ƒå¤‰æ•°
â”‚   â”œâ”€â”€ .env.local.example      # ç’°å¢ƒå¤‰æ•°ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ dist/                   # `nuxt generate` ã«ã‚ˆã‚‹é™çš„å‡ºåŠ›å…ˆ
â”‚
â”œâ”€â”€ docs/                        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ architecture/
â”‚   â”‚   â”œâ”€â”€ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ.md
â”‚   â”‚   â”œâ”€â”€ å®Ÿè£…è¨ˆç”».md
â”‚   â”‚   â””â”€â”€ è¦ä»¶å®šç¾©.md
â”‚   â””â”€â”€ tasks/                  # ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚       â””â”€â”€ 2025/06/23/
â”‚           â””â”€â”€ 202506230001.md
â”‚
â”œâ”€â”€ firebase.json               # Firebase Hosting & Functions è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ README.md                   # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚è¦ã¨ä½¿ã„æ–¹
â””â”€â”€ CLAUDE.md                   # Claude Codeç”¨ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸ”§ firebase.json ã®è¨­å®š

```json
{
  "functions": {
    "source": "functions",
    "predeploy": [
      "npm --prefix \"$RESOURCE_DIR\" run lint",
      "npm --prefix \"$RESOURCE_DIR\" run build"
    ]
  },
  "hosting": {
    "site": "fb-line-example",
    "public": "frontend/.output/public",
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ],
    "rewrites": [
      {
        "source": "/api/**",
        "function": "api"
      },
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  },
  "emulators": {
    "functions": {
      "port": 5001
    },
    "hosting": {
      "port": 5000
    },
    "auth": {
      "port": 9099
    },
    "ui": {
      "enabled": true
    }
  }
}
```

## ğŸ’¡ å‚™è€ƒ

- Nuxt ã‚¢ãƒ—ãƒªã¯ `nuxt generate` ã‚’ä½¿ã£ã¦ `dist/` ã«é™çš„ã‚µã‚¤ãƒˆã¨ã—ã¦ãƒ“ãƒ«ãƒ‰ã•ã‚Œã€Firebase Hosting ã®è¨­å®šã§ã¯ `.output/public` ã‹ã‚‰é…ä¿¡ã•ã‚Œã¾ã™ã€‚
- API ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆä¾‹: `/api/line-callback`ï¼‰ã¯ Firebase Functions ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚
- é–‹ç™ºãƒ»ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ãã‚Œãã‚Œç‹¬ç«‹ã—ã¦ç®¡ç†ã§ãã‚‹æ§‹æˆã§ã™ã€‚
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚Œã¦ã„ã¾ã™ã€‚
- Firebase Emulator ã‚’ä½¿ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚
- æ—¥æœ¬èªã¨è‹±èªã®ãƒã‚¤ãƒªãƒ³ã‚¬ãƒ«å¯¾å¿œï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã¨UIï¼‰ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚
- ã‚«ã‚¹ã‚¿ãƒ LINEèªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’å®Ÿè£…ã—ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒªãƒ³ã‚¯æ©Ÿèƒ½ã‚‚æä¾›ã—ã¦ã„ã¾ã™ã€‚
- ç’°å¢ƒå¤‰æ•°ã¯ `.env.local.example` ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è¨­å®šã—ã¾ã™ã€‚

